import{r as a,v as s,j as e,a3 as t,c as n,d as i,f as o,ae as r,T as d,F as l,h as c,af as m,I as p,ag as u,ah as h,ai as x,aj as g,i as j,ak as b,y as f}from"./vendor-ClnM7L9C.js";import{A as y,h as w,s as v,a as k,b as C,c as S}from"./index-DQ7WhwzY.js";function D(){const{state:D,dispatch:I}=a.useContext(y),{loggedIn:T}=D,W=s(),[q,P]=a.useState(!1),[E,F]=a.useState(!1);if(T)return e.jsx(t,{to:"/"});return e.jsx(n,{component:"main",maxWidth:"xs",children:e.jsxs(i,{sx:{marginTop:8,display:"flex",alignItems:"center",flexDirection:"column"},children:[e.jsx(o,{sx:{m:1,bgcolor:"secondary.main"},children:e.jsx(r,{})}),e.jsx(d,{component:"h1",variant:"h5",children:"Sign in"}),e.jsxs(i,{component:"form",onSubmit:async a=>{a.preventDefault();const s=new FormData(a.currentTarget),e=s.get("email"),t=s.get("password"),n={query:"/api/auth/login",method:"POST",dispatch:I,body:{email:e,password:t}},i=await w(n),{success:o,teamId:r,accessToken:d,status:l}=i;if(200===l&&o&&(v(I,!0),k(I,e),r&&d)){C(I,r);const a={query:`/api/v1/teams/${r}`,method:"GET",dispatch:I,headers:{authorization:`Bearer ${d}`}},{data:s,success:e}=await w(a);s&&e&&S(I,{...s})}},sx:{mt:1,width:"100%"},children:[e.jsxs(l,{fullWidth:!0,children:[e.jsx(c,{required:!0,fullWidth:!0,autoFocus:!0,id:"email",name:"email",margin:"normal",label:"Email",autoComplete:"Email",inputProps:{type:"email"}}),e.jsx(c,{required:!0,fullWidth:!0,id:"password",margin:"normal",name:"password",label:"Password",autoComplete:"password",type:E?"text":"password",sx:{backgroundColor:"rgb(232,240,254)"},InputProps:{endAdornment:e.jsx(m,{position:"end",children:e.jsx(p,{edge:"end",onClick:()=>F((a=>!a)),onMouseDown:a=>{a.preventDefault()},"aria-label":"toggle password visibility",children:E?e.jsx(u,{}):e.jsx(h,{})})})}}),e.jsx(x,{label:"Remember me",control:e.jsx(g,{color:"primary",checked:q,onChange:a=>{P(a.target.checked)}})})]}),e.jsx(j,{fullWidth:!0,type:"submit",variant:"contained",sx:{mt:3,mb:2},children:"Sign In"})]}),e.jsx(b,{container:!0,children:e.jsxs(b,{item:!0,typography:"body2",children:["Don't have an account?"," ",e.jsx(f,{variant:"body1",component:"button",onClick:()=>W("/signup"),children:"Sign Up"})]})})]})})}export{D as default};
